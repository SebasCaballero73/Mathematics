%========Top Matter=========== (fold)
\documentclass[final,expand]{problemset}
% For plot: pfdplots and settings
\usepackage{pgfplots}
\pgfplotsset{width=7cm,
	compat=newest,
	label style={font=\small},
	legend style={font=\small}
}
%========top_matter=========== (end)

\begin{document}
\heading[Caballero]{SebastiÃ¡n Caballero}{2023}{Problem set}{30 Days of ML}

\section{Systems of linear equations, Matrices, and vector spaces, rank of matrices, Linear maps, and affine spaces}
\problem We consider $(\mathbb{R} \setminus \{-1\}, \star)$ where:
\begin{align*}
	a \star b &= a + ab + b
\end{align*}
for $a, b \in \mathbb{R} \setminus \{-1\}$. Show that this is an abelian group and solve $3 \star x \star x = 15$.

\solution{
	We prove this showing that the five axioms are true:
	\begin{itemize}
		\item First, suppose that $a + ab + b = -1$ and so we would have that $a(1 + b) + b = -1$, and so we have $a(1 + b) = - (1 + b)$ and since $b \neq 1$ we can assure that $1 + b \neq 0$ so $a = -1$ which is a contradiction to the hypothesis that $a \neq 1$, so $\star$ is closed under the set.
		\item Now, we want to prove associativity(We pay attention to the associativity in the real numbers)
		\begin{align*}
			a \star (b \star c) &= a \star (b + bc + c) & (a \star b) \star c &= (a + ab + b) \star c\\
			&= a + a(b + bc + c) + (b + bc + c) & &= (a + ab + b) + c(a + ab + b) + c\\
			&= a + ab + abc + ac + b + bc + c & &= a + ab + b + ac + abc + bc + c
		\end{align*}
		and so it is clear that they are the same.
		\item Note that the element $0$ is an identity element because:
		\begin{align*}
			a \star 0 &= a + a \cdot 0 + 0 & 0 \star a &= 0 + a \cdot 0 + a\\
			&= a & &= a
		\end{align*}
		\item The inverse element for $x$ is $\frac{-x}{1 + x}$ since:
		\begin{align*}
			x \star \frac{-x}{1 + x} &= x - x \cdot \frac{x}{1 + x} - \frac{x}{1 + x}\\
			&= x - \frac{x^2}{1 + x} - \frac{x}{1 + x}\\
			&= \frac{x + x^2}{1 + x} - \frac{x^2}{1 + x} - \frac{x}{1 + x}\\
			&= 0
		\end{align*}
		And the commutated case is the same, so it has inverses.
		\item The commutativity is a consequence of these properties in $\mathbb{R}$:
		\begin{align*}
			a \star b &= a + ab + b\\
			&= b + ba + a\\
			&= b \star a
		\end{align*}
	\end{itemize}

	And so we conclude that $(\mathbb{R} \setminus \{-1\}, \star)$ is an abelian group. For the equation, we do:
	\begin{align*}
		3 \star x \star x &= 15\\
		3 \star (2x + x^2) &= 15\\
		3 + 3(2x + x^2) + (2x + x^2) &= 15\\
		6x + 3x^2 + 2x + x^2 &= 12\\
		4x^2 + 8x &= 12\\
		x^2 + 2x &= 3\\
		x^2 + 2x - 3 &= 0\\
		(x -1)(x+3) &= 0 
	\end{align*}
	And therefore we conclude that $x = 1$ or $x = -3$. If we put this into the equation we have:
	\begin{align*}
		3 \star 1 \star 1 &= 3 \star 3 & 3 \star (-3 \star (-3)) &= 3 \star 3\\
		&= 3 + 9 + 3 & &= 3 + 9 + 3\\
		&= 15 & &= 15
	\end{align*}
	So the solutions are $x = 1$ and $x = -3$.
}

\problem Consider the set $\mathcal{G}$ of $3 \times 3$ matrices defined as follows:
\begin{align*}
	\mathcal{G} &= \left\{\begin{bmatrix}1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1 \end{bmatrix} \in \mathbb{R}^{3 \times 3} \, \, \vline \, \, x, y, z \in \mathbb{R}\right\}
\end{align*}
And we define $\cdot$ as the standard matrix multiplication. Is $(\mathcal{G}, \cdot)$ a group? If yes, is it abelian?

\solution{
	We prove this showing that the four axioms are true:
	\begin{itemize}
		\item First, it is closed under $\cdot$ since:
		\begin{align*}
			\begin{bmatrix}
				1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & a & c\\ 0 & 1 & b\\ 0 & 0 & 1
			\end{bmatrix} &= \begin{bmatrix}
				1 & a +x & c + bx + z\\ 0 & 1 & b+y\\ 0 & 0 & 1
			\end{bmatrix}
		\end{align*}
		And since the operations of addition and product of real numbers are closed, by definition the matrix is also in $\mathcal{G}$ so it is a closed operation.

		\item We can prove the associativity by taking three matrices and show that their product don't vary. 
		\begin{align*}
			\left(\begin{bmatrix}
				1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & a & c\\ 0 & 1 & b\\ 0 & 0 & 1
			\end{bmatrix}\right) \cdot \begin{bmatrix}
				1 & k & m\\ 0 & 1 & n\\ 0 & 0 & 1
			\end{bmatrix} &= \begin{bmatrix}
				1 & a +x & c + bx + z\\ 0 & 1 & b+y\\ 0 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & a +x & c + bx + z\\ 0 & 1 & b+y\\ 0 & 0 & 1
			\end{bmatrix}\\
			&= \begin{bmatrix}
				1 & a + k + x& m + an +ax + c + bx + z\\
				0 & 1 & b + n + y\\
				0 & 0 & 1
			\end{bmatrix}
		\end{align*}
		And if we make the other option:
		\begin{align*}
			\begin{bmatrix}
				1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
			\end{bmatrix} \cdot \left(\begin{bmatrix}
				1 & a & c\\ 0 & 1 & b\\ 0 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & k & m\\ 0 & 1 & n\\ 0 & 0 & 1
			\end{bmatrix}\right) &= \begin{bmatrix}
				1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & a + k & m + an + c\\
				0 & 1 & n + b\\
				0 & 0 & 1
			\end{bmatrix}\\
			&= \begin{bmatrix}
				1 & a + k + x & m + an + c + xn+ bx\\
				0 & 1 & b + n + y\\
				0 & 0 & 1
			\end{bmatrix}
		\end{align*}
		And we can see that they are the same, so $\cdot$ is associative.

		\item Note that the matrix $I_3$ is also in the set since $0 \in \mathbb{R}$, and we know that any matrix $3 \times 3$ operated with $I_3$ is the same, so $I_3$ is the identity for $\mathcal{G}$.
		\item For finding the inverse matrix for an element in $\mathcal{G}$ we do the next:
		\begin{align*}
			\begin{bmatrix}
				1 & x & z &\vline & 1 & 0 & 0\\ 0 & 1 & y &\vline & 0 & 1 & 0\\ 0 & 0 & 1 &\vline & 0 & 0 &1
			\end{bmatrix} &\longrightarrow \begin{bmatrix}
				1 & x & 0 &\vline & 1 & 0 & -z\\ 0 & 1 & 0 &\vline & 0 & 1 & -y\\ 0 & 0 & 1 &\vline & 0 & 0 &1
			\end{bmatrix} \begin{matrix}
				\\ -zR_3 \\ -yR_3
			\end{matrix}\\
			&\longrightarrow \begin{bmatrix}
				1 & 0 & 0 &\vline & 1 & -x & xy-z\\ 0 & 1 & 0 &\vline & 0 & 1 & -y\\ 0 & 0 & 1 &\vline & 0 & 0 &1
			\end{bmatrix}\begin{matrix}
				-xR_2\\ \\ 
			\end{matrix}
		\end{align*}

		So the matrix done in the right side is the inverse of the matrix in $\mathcal{G}$. For that, note that:
		\begin{align*}
			\begin{bmatrix}
				1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & -x & xy-z\\ 0 & 1 & -y\\ 0 & 0 & 1
			\end{bmatrix} &= \begin{bmatrix}
				1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & 1
			\end{bmatrix}
		\end{align*}
		And the same is true for the converse, and since $-x, -y$ and $xy-z$ are also real numbers, we have shown the existence of inverses in $\mathcal{G}$.
	\end{itemize}

	Note that this group is not abelian since:
	\begin{align*}
		\begin{bmatrix}
			1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
		\end{bmatrix} \cdot \begin{bmatrix}
			1 & a & c\\ 0 & 1 & b\\ 0 & 0 & 1
		\end{bmatrix} &= \begin{bmatrix}
			1 & a +x & c + bx + z\\ 0 & 1 & b+y\\ 0 & 0 & 1
		\end{bmatrix} & \begin{bmatrix}
			1 & a & c\\ 0 & 1 & b\\ 0 & 0 & 1
		\end{bmatrix} \cdot \begin{bmatrix}
			1 & x & z\\ 0 & 1 & y\\ 0 & 0 & 1
		\end{bmatrix} &= \begin{bmatrix}
			1 & a + x & z + ay + c\\ 0 & 1 & b + y\\ 0 & 0& 1
		\end{bmatrix}
	\end{align*}
	And if $bx \neq ay$ then they are not the same. So, the group is not abelian.
}

\problem If it is possible compute the next products.

\solution{
	The products are:
	\begin{enumerate}
		\item \begin{align*}
			\begin{bmatrix}
				1 & 2\\ 4 & 5\\ 7 & 8
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & 1 & 0\\ 0 & 1 & 1\\ 1 & 0 & 1
			\end{bmatrix}
		\end{align*}

		This product is not possible since the first matrix is a $3 \times 2$ matrix and the other one is a $3 \times 3$ matrix, and hence $3 \neq 2$ we cannot operate it.

		\item \begin{align*}
			\begin{bmatrix}
				1 & 2 & 3\\ 4 & 5 & 6\\ 7 & 8 & 9
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & 1 & 0\\  0 & 1 & 1\\ 1 & 0 & 1
			\end{bmatrix} &= \begin{bmatrix}
				4 & 3 & 5\\ 10 & 9 & 11\\ 16 & 15 & 17
			\end{bmatrix}
		\end{align*}

		\item \begin{align*}
			\begin{bmatrix}
				1 & 1 & 0\\  0 & 1 & 1\\ 1 & 0 & 1
			\end{bmatrix} \cdot \begin{bmatrix}
				1 & 2 & 3\\ 4 & 5 & 6\\ 7 & 8 & 9
			\end{bmatrix} &= \begin{bmatrix}
				5 & 7 & 9\\ 11 & 13 & 15\\ 8 & 10 & 12
			\end{bmatrix}
		\end{align*}

		\item \begin{align*}
			\begin{bmatrix}
				1 & 2 & 1 & 2\\ 4 & 1 & -1 & -4
			\end{bmatrix} \cdot \begin{bmatrix}
				 0 & 3\\ 1 & -1\\ 2 & 1 \\ 5 & 2
			\end{bmatrix} &= \begin{bmatrix}
				14 & 5\\ -21 & 2
			\end{bmatrix}
		\end{align*}

		\item \begin{align*}
			\begin{bmatrix}
				0 & 3\\ 1 & -1\\ 2 & 1 \\ 5 & 2
		   \end{bmatrix} \cdot \begin{bmatrix}
			1 & 2 & 1 & 2\\ 4 & 1 & -1 & -4
		\end{bmatrix} &= \begin{bmatrix}
			12 & 3 & -3 & -12\\
			-3 & 1 & 2 & 6\\
			6 & 5 & 1 & 0\\
			13 & 12 & 3 & 2
		\end{bmatrix}
		\end{align*}
	\end{enumerate}
}

\problem Find all the solutions in $x = \begin{bmatrix} x_1 \\ x_2\\ x_3\end{bmatrix} \in \mathbb{R}^3$ of the equation system $Ax = 12x$ where:
\begin{align*}
	A &= \begin{bmatrix}
		6 & 4 & 3\\ 6 & 0 & 9\\ 0 & 8 & 0
	\end{bmatrix}
\end{align*}
and $x_1 + x_2 + x_3 = 1$.

\solution{
	First, note that $Ax$ is:
	\begin{align*}
		\begin{bmatrix}
			6 & 4 & 3\\ 6 & 0 & 9\\ 0 & 8 & 0
		\end{bmatrix} \begin{bmatrix}
			x_1 \\ x_2 \\ x_3
		\end{bmatrix} &= \begin{bmatrix}
			6x_1 + 4x_2 + 3x_3\\ 6x_1 + 9x_3\\  8x_2
		\end{bmatrix}
	\end{align*}
	And so we want that:
	\begin{align*}
		\begin{bmatrix}
			6x_1 + 4x_2 + 3x_3\\ 6x_1 + 9x_3\\  8x_2
		\end{bmatrix} &= \begin{bmatrix}
			12x_1 \\ 12x_2 \\ 12x_3
		\end{bmatrix}
	\end{align*}
	So we have the equations\\
	\begin{align*}
		\begin{matrix}
			6x_1 &+& 4x_2 &+& 3x_3 &= 12x_1\\
			6x_1 &&&+& 9x_3 &= 12x_2\\
			&& 8x_2&& &= 12x_3
		\end{matrix}
	\end{align*}
	And so we end up with the system:
	\begin{align*}
		\begin{matrix}
			-6x_1 &+& 4x_2 &+& 3x_3 &= 0\\
			6x_1 &-& 12x_2 &+& 9x_3 &= 0\\
			&& 8x_2& -&12x_3 &= 0
		\end{matrix}
	\end{align*}
	Which can be expresed in the next matrix:
	\begin{align*}
		\begin{bmatrix}
			-6 & 4 & 3\\ 6 & -12 & 9\\ 0 & 8 & -12
		\end{bmatrix} &\longrightarrow \begin{bmatrix}
			-6 & 4 & 3\\ 0 & -8 & 12\\ 0 & 8 & -12
		\end{bmatrix}\begin{matrix}
			\\ -R_1\\ \\
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			-6 & 4 & 3\\ 0 & -8 & 12\\ 0 & 0 & 0
		\end{bmatrix} \begin{matrix}
			\\ \\ -R_2
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			-6 & 4 & 3\\ 0 & -2 & 3\\ 0 & 0 & 0
		\end{bmatrix} \begin{matrix}
			\\ \frac{1}{4}R_2 \\ \\
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			-6 & 6 & 0\\ 0 & -2 & 3\\ 0 & 0 & 0
		\end{bmatrix} \begin{matrix}
			-R_2 \\ \\ \\
		\end{matrix}
	\end{align*}

	Which lead us to the next equations:
	\begin{align*}
		-6x_1 + 6x_2 &= 0\\
		-2x_2 + 3x_3 &= 0
	\end{align*}
	From which we derive that:
	\begin{align*}
		x &= \begin{bmatrix}
			\frac{3}{2} x_3 \\ \frac{3}{2} x_3\\ x_3
		\end{bmatrix}
	\end{align*}

	And with the other condition, we must satisfy the equation as:
	\begin{align*}
		x_1 + x_2 + x_3 &= 1\\
		\frac{3}{2}x_3 + \frac{3}{2}x_3 + x_3 &= 1\\
		4x_3 &= 1\\
		x_3 &= \frac{1}{4}
	\end{align*}
}

\problem Which of the following sets are subsets of $\mathbb{R}^3$?

\solution{
	\begin{enumerate}
		\item $A = \{(\lambda, \lambda + \mu^3, \lambda-\mu^3) | \lambda, \mu \in \mathbb{R}\}$. Take two elements in $A$ and a scalar $c \in \mathbb{R}$, then:
		\begin{align*}
			c(\lambda_1, \lambda_1 + \mu_1^3, \lambda_1-\mu_1^3) + (\lambda_2, \lambda_2 + \mu_2^3, \lambda_2-\mu_2^3) &= (c\lambda_1, c\lambda_1 + c\mu_1^3, c\lambda_1 - c\mu_1^3) + (\lambda_2, \lambda_2 + \mu_2^3, \lambda_2-\mu_2^3)\\
			&= (c\lambda_1 + \lambda_2, (c\lambda_1 + \lambda_2) + (c\mu_1^3 + \mu_2^3), (c\lambda_1 + \lambda_2) - (c\mu_1^3 + \mu_2^3))
		\end{align*}
		And since $\sqrt[3]{c\mu_1^3 + \mu_2^3}$ will always be a real number, then the linear combination of these elements is in $A$ and so it is a subspace of $\mathbb{R}^3$

		\item $B = \{(\lambda^2, -\lambda^2, 0)|\lambda \in \mathbb{R}\}$. If you take $c = -1$ and two elements in $B$ we have:
		\begin{align*}
			-(\lambda_1^2, -\lambda_1^2, 0) + (\lambda_2^2, -\lambda_2^2, 0) &= (-\lambda_1^2, \lambda_1^2, 0) + (\lambda_2^2, -\lambda_2^2, 0)\\
			&= (\lambda_2^2 - \lambda_1^2, \lambda_1^2 - \lambda_2^2, 0)\\
		\end{align*}
		And if $\lambda_1^2 > \lambda_2^2$ then it is not defined its square and so it would not be an element of $B$. So $B$ is not a subspace of $\mathbb{R}^3$

		\item $C = \{(\lambda_1, \lambda_2, \lambda_3)| \lambda_1 - 2\lambda_2 + 3\lambda_3 = \gamma\}$ for a fixed $\gamma$. If we take two elements of $C$ we would have the equations:
		\begin{align*}
			\lambda_1 - 2\lambda_2 + 3\lambda_3 &= \gamma\\
			\psi_1- 2\psi_2 + 3\psi_3 &= \gamma
		\end{align*}
		And adding them up we get:
		\begin{align*}
			(\lambda_1 + \psi_1) - 2(\lambda_2 + \psi_2) + 3(\lambda_3 + \psi_3) &= 2\gamma
		\end{align*}
		So, unless $\gamma = 0$ we conclude that $C$ is not a subspace of $\mathbb{R}^3$.

		\item $D = \{(\lambda_1, \lambda_2, \lambda_3) | \lambda_2 \in \mathbb{Z}\}$. If we take an element $c \in \mathbb{R}$ such that $c$ is irrational and we multiply it by an element of $D$ then $c\lambda_2$ would not be an integer and so that element would not be on $D$. Therefore, $D$ is not a subspace of $\mathbb{R}^3$.
	\end{enumerate}
}

\problem Write the vector $\begin{bmatrix}1 \\ -2 \\ 5\end{bmatrix}$ as a linear combination of the vectors $x_1 = \begin{bmatrix}1 \\ 1 \\ 1\end{bmatrix}$, $x_2 = \begin{bmatrix}1 \\ 2 \\ 3\end{bmatrix}$ and $x_3 \begin{bmatrix}2\\-1\\1\end{bmatrix}$.

\solution{
	For that, let's write the matrix of the system of equations as:
	\begin{align*}
		\begin{bmatrix}
			1 & 1 & 2 & \vline & 1\\
			1 & 2 & -1 &\vline & -2\\
			1 & 3 & 1 &\vline & 5
		\end{bmatrix} &\longrightarrow \begin{bmatrix}
			1 & 1 & 2 & \vline & 1\\
			0 & 1 & -3 &\vline & -3\\
			0 & 2 & -1 &\vline & 4
		\end{bmatrix}\begin{matrix}
			\\ -R_1 \\ -R_1
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			1 & 1 & 2 & \vline & 1\\
			0 & 1 & -3 &\vline & -3\\
			0 & 0 & 5 &\vline & 10
		\end{bmatrix}\begin{matrix}
			\\  \\ -2R_2
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			1 & 1 & 2 & \vline & 1\\
			0 & 1 & -3 &\vline & -3\\
			0 & 0 & 1 &\vline & 2
		\end{bmatrix}\begin{matrix}
			\\  \\ \frac{1}{2}R_3
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			1 & 1 & 0 & \vline & -3\\
			0 & 1 & 0 &\vline & 3\\
			0 & 0 & 1 &\vline & 2
		\end{bmatrix}\begin{matrix}
			-2R_3\\ +3R_3 \\ \\
		\end{matrix}\\
		&\longrightarrow \begin{bmatrix}
			1 & 0 & 0 & \vline & -6\\
			0 & 1 & 0 &\vline & 3\\
			0 & 0 & 1 &\vline & 2
		\end{bmatrix}\begin{matrix}
			-R_2\\ \\ \\
		\end{matrix}\\
	\end{align*}
	And so we have the linear combination:
	\begin{align*}
		-6\begin{bmatrix}
			1\\1\\1
		\end{bmatrix} + 3\begin{bmatrix}
			1 \\2\\3
		\end{bmatrix} + 2\begin{bmatrix}
			2\\-1\\1
		\end{bmatrix} &= \begin{bmatrix}
			-6\\-6\\-6
		\end{bmatrix} + \begin{bmatrix}
			3 \\6\\9
		\end{bmatrix} + \begin{bmatrix}
			4\\-2\\2
		\end{bmatrix}\\
		&= \begin{bmatrix}
			1\\-2\\5
		\end{bmatrix}
	\end{align*}
}

\problem
Consider the linear mapping defined by:
\begin{align*}
	\begin{matrix}
		\phi: & \mathbb{R}^3 & \to & \mathbb{R}^4\\
		& (x_1, x_2, x_3) & \mapsto & (3x_1+2x_2+x_3, x_1+x_2+x_3, x_1-3x_2, 2x_1 + 3x_2 + x_3)
	\end{matrix}
\end{align*}
Find the matrix associated with the linear transformation, determine the rank of the matrix and compute the image, the kernel and their dimension.

\solution{
	First, we apply the transformation to the canonical basis in $\mathbb{R}^3$ as:
	\begin{align*}
		\phi(1, 0, 0) &= (3, 1, 1, 2)\\
		\phi(0, 1, 0) &= (2, 1, -3, 3)\\
		\phi(0, 0, 1) &= (1, 1, 0, 1)\\
	\end{align*}
	And so we end up with the matrix:
	\begin{align*}
		A &= \begin{bmatrix}
			3 & 2 & 1\\ 1 & 1 &1 \\ 1 & -3 & 0\\ 2 & 3 & 1
		\end{bmatrix}
	\end{align*}
	Now, if we reduce it to the echelon form:
	\begin{align*}
		\begin{bmatrix}
			3 & 2 & 1 & \vline& a\\ 1 & 1 &1 & \vline& b\\ 1 & -3 & 0 &\vline& c\\ 2 & 3 & 1 &\vline& d
		\end{bmatrix} &\longrightarrow \begin{bmatrix}
			1 & 1 & 1 &\vline& b\\ 3 & 2 &1 &\vline& a\\ 1 & -3 & 0 &\vline& c\\ 2 & 3 & 1 &\vline& d
		\end{bmatrix}\begin{matrix}
			R_2 \\ R_1 \\ \\ \\
		\end{matrix}\\
		&\longrightarrow
			\begin{bmatrix}
				1 & 1 & 1 &\vline& b\\ 0 & -1 & -2 &\vline& a-3b\\ 0 & -4 &-1 &\vline& c - b\\ 0 & 1 & -1 &\vline& d - 2b
			\end{bmatrix}\begin{matrix}
				 \\ -3R_1 \\ -R_1\\ -2R_1\\
			\end{matrix}\\
			&\longrightarrow
			\begin{bmatrix}
				1 & 1 & 1 &\vline& b\\ 0 & 1 & 2 &\vline& 3b - a\\ 0 & 4 &1 &\vline& b - c\\ 0 & -1 & 1 &\vline& 2b - d
			\end{bmatrix}\begin{matrix}
				 \\ -R_2 \\ -R_3\\ -R_4\\
			\end{matrix}\\
			&\longrightarrow
			\begin{bmatrix}
				1 & 1 & 1 &\vline& b \\ 0 & 1 & 2 &\vline& 3b - a\\ 0 & 0 & -3 &\vline& -3b-c\\ 0 & 0 & -2 &\vline& 3b - d
			\end{bmatrix}\begin{matrix}
				 \\  \\ -4R_1\\ +R_1\\
			\end{matrix}\\
			&\longrightarrow
			\begin{bmatrix}
				1 & 1 & 1  &\vline& b\\ 0 & 1 & 2 &\vline& 3b-a\\ 0 & 0 & 1 &\vline& b + \frac{c}{3}\\ 0 & 0 & -1 &\vline& d - 3b
			\end{bmatrix}\begin{matrix}
				 \\  \\ -\frac{1}{3}R_3\\ -R_4\\
			\end{matrix}\\
			&\longrightarrow
			\begin{bmatrix}
				1 & 1 & 1 &\vline& b\\ 0 & 1 & 2&\vline& 3b-a \\ 0 & 0 & 1 &\vline& b + \frac{c}{3}\\ 0 & 0 & 0 &\vline& d + \frac{c}{3} - 2b
			\end{bmatrix}\begin{matrix}
				 \\  \\ \\ +R_3\\
			\end{matrix}\\
			&\longrightarrow
			\begin{bmatrix}
				1 & 1 & 0 &\vline& -\frac{c}{3}\\ 0 & 1 & 0&\vline& b - a - \frac{2c}{3} \\ 0 & 0 & 1 &\vline& b + \frac{c}{3}\\ 0 & 0 & 0 &\vline& d + \frac{c}{3} - 2b
			\end{bmatrix}\begin{matrix}
				 -R_3\\ -2R_3  \\ \\\\
			\end{matrix}\\
			&\longrightarrow
			\begin{bmatrix}
				1 & 0 & 0 &\vline& a - b + \frac{c}{3}\\ 0 & 1 & 0&\vline& b - a - \frac{2c}{3} \\ 0 & 0 & 1 &\vline& b + \frac{c}{3}\\ 0 & 0 & 0 &\vline& d + \frac{c}{3} - 2b
			\end{bmatrix}\begin{matrix}
				 -R_2\\   \\ \\\\
			\end{matrix}\\
	\end{align*}

	So the image is the set:
	\begin{align*}
		Im(\phi) = \{(a, b, c, d) \in \mathbb{R}^4| d + \frac{c}{3} - 2b = 0 \}
	\end{align*}
	Note that when $(a, b, c, d) = (0, 0, 0, 0)$ then the system only has the trivial solution and so we conclude that the rank of $A$ is $3$ and that the kernel is just $\{0\}$. By the rank theorem, we have:
	\begin{align*}
		\dim V &= \dim(\ker(\phi)) + \dim(\phi(V))\\
		\dim \mathbb{R}^3 &= \dim(\{0\}) + \dim(\phi(V))\\
		3 &= 0 + \dim(\phi(V))\\
		\dim(\phi(V)) &= 3
	\end{align*}
	And so we conclude that even when the linear transformation is monic, it is not epic.
}

\problem Let $V$ be a vector space. Let $f$ and $g$ two automorphism over $E$ such that $f \circ g = Id_E$. Show that $\ker(f) = \ker(g \circ f)$, $Im(g) = Im(g \circ f)$ and that $\ker(f) \cap Im(g) = \{0_E\}$.

\solution{
	First, we want to show that $\ker(g \circ f) = \{0_E\}$ since $f$ is an automorphism. So, suppose that $v \in E$ is such that $(g \circ f)(v) = g(f(v)) = 0$. Since $g$ is an automorphism, we conclude that $f(v) = 0$ and since $f$ is also an automorphism, we conclude that $v = 0$. So, $\ker(f) = \ker(g \circ f)$.\\

	Also, we want to show $Im(g \circ f) = E$, so take $v \in E$, since $g$ is an automorphism we can find $u \in E$ such that $g(u) = v$. And also, since $f$ is an automorphism, we can find $w \in E$ such that $f(w) = u$, so we have that:
	\begin{align*}
		(g \circ f)(w) &= g(f(w))\\
		&= g(u)\\
		&= v
	\end{align*}
	And so we conclude that $Im(g) = Im(g \circ f)$. Note that also $0 \in Im(g)$ but the only element in $\ker(f)$ is $0$, so we must have that $\ker(f) \cap Im(g) = \{0_E\}$.
}

\problem Let $F = \{(x, y, z) \in \mathbb{R}^3 | x + y - z = 0\}$ and $G =\{(a- b, a+b, a-3b) \in \mathbb{R}^3 | a, b \in \mathbb{R}\}$. Prove that they are subspaces of $\mathbb{R}^3$, calculate $F \cap G$ and then using basis for $F$ and $G$ check the result.

\solution{
	First, we are going that both sets are subspaces of $\mathbb{R}^3$:
	\begin{itemize}
		\item Let $(x, y, z), (a, b, c) \in F$ and let $r \in \mathbb{R}$, we want to show that their linear combination is in $F$:
		\begin{align*}
			r(x, y, z) + (a, b, c) &= (rx, ry, rz) + (a, b, c)\\
			&= (rx + a, ry+b, rz+c) 
		\end{align*}
		And by definition, we have the equations:
		\begin{align*}
			x + y - z &= 0\\
			a + b - c &= 0\\
		\end{align*}
		If we multiply the first by $r$ we get:
		\begin{align*}
			rx + ry - rz &= 0\\
			a + b - c &= 0\\
		\end{align*}
		and if we add them up:
		\begin{align*}
			(rx + a) + (ry + b) - (rz + c) &= 0
		\end{align*}
		Which proves that $(rx + a, ry+b, rz+c) \in F$ and so it is a subspace.

		\item Let $(a - b, a+b, a-3b), (x - y, x+y, x-3y)$ and $r \in \mathbb{R}$ we want to show that their linear combination is in $G$:
		\begin{align*}
			r(a-b, a+b, a-3b) + (x-y, x+y, x-3y) &= (ar-br, ar+br, ar-3br) + (x-y, x+y, x-3y)\\
			&= ((ar + x) - (br + y), (ar + x) + (br + y), (ar + x) - 3(br + y))
		\end{align*}
		and since $ar+x, br+y \in \mathbb{R}$, by definition $((ar + x) - (br + y), (ar + x) + (br + y), (ar + x) - 3(br + y))$ and so $G$ is a subspace.
	\end{itemize}

	Now, if we calculate $F \cap G$, we take a vector $(x, y, z) \in F \cap G$ then it is necessary that $x + y - z = 0$ and for $a, b \in \mathbb{R}$ we got $x = a - b$, $y = a + b$ and $z = a - 3b$. If we replace it into the another equation we get:
	\begin{align*}
		x + y - z &= 0\\
		a - b + a + b - a + 3b &= 0\\
		a + 3b &= 0\\
		b &= -\frac{a}{3}
	\end{align*}

	and so we get:
	\begin{align*}
		x &= \frac{4a}{3}\\
		y &= \frac{2a}{3}\\
		z &= 2a
	\end{align*}

	so we got vectors of the form $\left(\frac{4a}{3}, \frac{2a}{3}, 2a\right)$ such that $a \in \mathbb{R}$. Now, we are going to find a basis for $F$ and for $G$.

	\begin{itemize}
		\item For $F$, note that each vector is of the form $(x, y, z)$ with $x + y - z = 0$ and so $z = x + y$, so we can express it:
		\begin{align*}
			(x, y, z) &= (x, y, x+y)\\
			&= (x, 0, x) + (0, y, y)\\
			&= x(1, 0, 1) + y(0, 1, 1)
		\end{align*}
		And so a basis for $F$ is $\{(1, 0, 1), (0, 1, 1)\}$.

		\item For $G$, we have vectors of the form $(a-b, a+b, a-3b)$ so we can descompose it like:
		\begin{align*}
			(a-b, a+b, a-3b) &= (a, a, a) + (-b, b, -3b)\\
			&= a(1, 1, 1) + b(-1, 1, -3)
		\end{align*}
		And so a basis for $G$ is $\{(1, 1, 1), (-1, 1, -3)\}$.
	\end{itemize}

	And now we express a vector of $F \cap G$ as a linear combination with scalars $x, y, a, b \in \mathbb{R}$ as:
	\begin{align*}
		x(1, 0, 1) + y(0, 1, 1) &= a(1, 1, 1) + b(-1, 1, -3)\\
		(x, 0, x) + (0, y, y) &= (a, a, a) + (-b, b, -3b)\\
		(x, y, x+y) &= (a-b, a+b, a-3b)
	\end{align*}
	and so we get $x = a - b$, $y = a + b$ and $x + y = a - 3b$, but we can replace in this last equation as:
	\begin{align*}
		x + y &= a - 3b\\
		a - b + a + b &= a - 3b\\
		2a &= a - 3b\\
		a &= -3b\\
		b &= -\frac{a}{3}
	\end{align*}

	and so we get the same result as we did without the basis.
}

\section{Analytic Geometry}

\problem Show that $\langle \cdot, \cdot \rangle$ defined for all $x = (x_1, x_2) \in \mathbb{R}^2$ and $y = (y_1, y_2) \in \mathbb{R}^2$ by: $$\langle x, y\rangle = x_1y_1 - (x_1y_2 + x_2y_1) + 2(x_2y_2)$$ is an inner product.

\solution{
	We need to prove three things. That $\langle \cdot, \cdot \rangle$ is a bilinear map, that it is symmetric and that is positive definite. 
	\begin{itemize}
		\item First, to prove that it is a bilinear transformation, take $(x_1, x_2), (y_1, y_2), (z_1, z_2) \in \mathbb{R}^2$ and $a, b \in \mathbb{R}$. Then:
		\begin{align*}
			\langle (x_1, x_2), (ay_1 + bz_1, ay_2 + bz_2) \rangle &= x_1(ay_1 + bz_1) - (x_1 \cdot (ay_2 + bz_2) + x_2(ay_1 + bz_1)) + 2x_2(ay_2 + bz_2)\\
			&= ax_1y_1 + bx_1z_1 - (ax_1y_2 + bx_1z_2 + ax_2y_1 + bx_2z_1) + 2ax_2y_2 + 2bx_2z_2\\
			&= ax_1y_1 - ax_1y_2 - ax_2y_1 + 2a(x_2y_2) + bx_1z_1 - bx_1z_2 - bx_2z_1 + 2b(x_2z_2)\\
			&= a(x_1y_1 - (x_1y_2 + x_2y_1) + 2(x_2y_2)) + b(x_1z_1 - (x_1z_2 + x_2z_1) + 2(x_2z_2))\\
			&= a\langle (x_1, x_2), (y_1, y_2)\rangle + b\langle (x_1, x_2), (z_1, z_2)\rangle
		\end{align*}

		In a similar way we prove that $\langle (ax_1 + by_1, ax_2 + by_2), (z_1, z_2) \rangle = a\langle (x_1, x_2), (z_1, z_2)\rangle + b\langle (y_1, y_2), (z_1, z_2) \rangle$, so we conclude that it is a bilinear transformation.

		\item We want to show that this transformation is symmetric. So:
		\begin{align*}
			\langle x, y \rangle &= x_1y_1 - (x_1y_2 + x_2y_1) + 2(x_2y_2)\\
			&= y_1x_1 - (y_1x_2 + y_2x_1) + 2(y_2x_2)\\
			&= \langle y, x\rangle
		\end{align*}

		\item And for the last part, we want to show that it is positive define. That is, suppose that $(x_1, x_2) \neq (0, 0)$ so we want to show that its inner product is positive:
		\begin{align*}
			\langle (x_1, x_2), (x_1, x_2) \rangle &= x_1\cdot x_1 - (x_1x_2 + x_1x_2) + 2(x_2 \cdot x_2)\\
			&= x_1^2 - 2x_1x_2 + 2x_2^2\\
			&= x_1^2 - 2x_1x_2 + x_2^2 + x_2^2\\
			&= (x_1 - x_2)^2 + x_2^2
		\end{align*}
		And no matter the chooses of $x_1, x_2$ we always end up with a positive sum of squares, so $\langle x, x\rangle > 0$ and it is easy to see that $\langle 0, 0\rangle = 0$.
	\end{itemize}
}

\problem Consider $\mathbb{R}^2$ with $\langle \cdot, \cdot \rangle$ defined for all $x$ and $y$ in $\mathbb{R}^2$ as:
\begin{align*}
	\langle x, y \rangle &:= x^\top \begin{bmatrix}
		2 & 0\\ 1 & 2
	\end{bmatrix}y
\end{align*}
Is it an inner product?

\solution{
	First, we could rearrange the expression taking $x = (x_1, x_2)$ and $y = (y_1, y_2)$ as:
	\begin{align*}
		\langle x, y \rangle &= \begin{bmatrix}
			x_1 & x_2
		\end{bmatrix} \begin{bmatrix}
			2 & 0\\ 1 & 2
		\end{bmatrix} \begin{bmatrix}
			y_1 \\ y_2
		\end{bmatrix}\\
		&= \begin{bmatrix}
			x_1 & x_2
		\end{bmatrix} \begin{bmatrix}
			2y_1 \\ y_1 + 2y_2
		\end{bmatrix}\\
		&= 2x_1y_1 + x_2y_1 + 2x_2y_2
	\end{align*}
	And now we must to test the three conditions:
	\begin{itemize}
		\item First, we want to prove that it is a bilinear transformation:
		\begin{align*}
			\langle (x_1, x_2), (ay_1 + bz_1, ay_2 + bz_2)\rangle &= 2x_1(ay_1 + bz_1) + x_2(ay_1+bz_1) + 2x_2(ay_2 + bz_2)\\
			&= 2ax_1y_1 + 2bx_1z_1 + ax_2y_1 + bx_2z_1 + 2ax_2y_2 + 2bx_2z_2\\
			&= 2ax_1y_1 + ax_2y_1 + 2ax_2y_2 + 2bx_1z_1 + bx_2z_1 + 2bx_2z_2\\
			&= a(2x_1y_1 + x_2y_1 + 2x_2y_2) + b(x_1z_1 + x_2z_1 + x_2z_2)\\
			&= a\langle (x_1, x_2), (y_1, y_2)\rangle + b\langle (x_1, x_2), (z_1, z_2)\rangle
		\end{align*}
		And we can prove in a similar way that $\langle (ax_1 + by_1, ax_2 + by_2), (z_1, z_2) \rangle = a\langle (x_1, x_2), (y_1, y_2)\rangle + b\langle (x_1, x_2), (z_1, z_2)\rangle$. So we conclude that $\langle \cdot, \cdot \rangle$ is a bilinear transformation.

		\item Now, we need to show that it is symmetric:
		\begin{align*}
			\langle x, y \rangle &= 2x_1y_1 + x_2y_1 + 2x_2y_2\\
			&= 2x_2y_2 + y_1x_2 + 2x_1y_1
		\end{align*}

		But this does not implies that $y_1x_2 = y_2x_1$ so it is not symmetric and therefore it is not an inner product.
	\end{itemize}
}

\problem Compute the distance between $x = (1, 2, 3)$ and $y = (-1, -1, 0)$ using:
\begin{enumerate}
	\item $\langle x, y \rangle := x^\top y$
	\item $\langle x, y \rangle := x^\top y A$ with $A := \begin{bmatrix}
		2 & 1 & 0\\ 1 & 3 & -1\\ 0 & -1 & 2
	\end{bmatrix}$
\end{enumerate}

\solution{
	Remmber that the distance induced by a product is the norm induced by that inner product. We can first calculate $x-y$ as:
	\begin{align*}
		x - y &= (1, 2, 3) - (-1, -1, 0)\\
		&= (2, 3, 3)
	\end{align*}
	And so we do the norm of that vector under each of the inner products defined:
	\begin{enumerate}
		\item For $\langle x, y \rangle := x^\top y$, we have:
		\begin{align*}
			d(x, y) &= \|x-y\|\\
			&= \sqrt{\langle x-y, x-y\rangle}\\
			&= \sqrt{\langle (2, 3, 3), (2, 3, 3) \rangle}\\
			&= \sqrt{2^2 + 3^2 + 3^2}\\
			&= \sqrt{4 + 9 +9}\\
			&= \sqrt{22}
		\end{align*}

		\item For $\langle x, y \rangle := x^\top y A$ with $A := \begin{bmatrix}
			2 & 1 & 0\\ 1 & 3 & -1\\ 0 & -1 & 2
		\end{bmatrix}$, so if we make $\langle x-y, x-y\rangle$ we got:
		\begin{align*}
			\begin{bmatrix}
				2 & 3 & 3
			\end{bmatrix} \begin{bmatrix}
				2 & 1 & 0\\ 1 & 3 & -1\\ 0 & -1 & 2
			\end{bmatrix} \begin{bmatrix}
				2\\ 3\\ 3
			\end{bmatrix} &= \begin{bmatrix}
				2 & 3 & 3
			\end{bmatrix} \begin{bmatrix}
				7 \\ 8 \\ 3
			\end{bmatrix}\\
			&= 2 \cdot 7 + 3\cdot 8 + 3\cdot 3\\
			&= 14 + 24 + 9\\
			&= 47
		\end{align*}
		So we have:
		\begin{align*}
			d(x, y) &= \|x-y\|\\
			&= \sqrt{\langle x-y, x-y\rangle}\\
			&= \sqrt{\langle (2, 3, 3), (2, 3, 3) \rangle}\\
			&= \sqrt{47}\\
		\end{align*}
	\end{enumerate}
}

\problem Compute the angle between:
\begin{align*}
	x &= (1, 2) & y &= (-1, -1)
\end{align*}
using the inner products:
\begin{enumerate}
	\item $\langle x, y \rangle = x^\top y$
	\item $\langle x, y \rangle = x^\top By$ with $B = \begin{bmatrix}
		2 & 1\\ 1 & 3
	\end{bmatrix}$
\end{enumerate}
\solution{
	\begin{enumerate}
		\item With the usual product and the norm induced by that, we consider that:
		\begin{align*}
			\cos \omega &= \frac{|\langle x, y\rangle|}{\|x\| \|y\|}\\
			&= \frac{|1 \cdot (-1) + 2 \cdot (-1)|}{\sqrt{1^2 + 2^2} \sqrt{(-1)^2 + (-1)^2}}\\
			&= \frac{|-1 - 2|}{\sqrt{5} \sqrt{2}}\\
			&= \frac{3}{\sqrt{10}}\\
		\end{align*}
		And so we get that $\omega = \arccos \frac{3}{\sqrt{10}} \approx 18 \deg$ 

		\item It is convenient to compute the inner product with arbitrary $(x_1, x_2)$ and $(y_1, y_2)$:
		\begin{align*}
			\langle (x_1, x_2), (y_1, y_2)\rangle &= \begin{bmatrix}
				x_1 & x_2
			\end{bmatrix} \begin{bmatrix}
				2 & 1\\ 1 & 3
			\end{bmatrix} \begin{bmatrix}
				y_1 \\ y_2
			\end{bmatrix}\\
			&= \begin{bmatrix}
				x_1 & x_2
			\end{bmatrix}\begin{bmatrix}
				2y_1 + y_2\\
				y_1 + 3y_2
			\end{bmatrix}\\
			&= 2x_1y_1 + x_1y_2 + y_1x_2 + 3x_2y_2
		\end{align*}
		Now, with that we are ready to compute the angle given by this inner product.
		\begin{align*}
			\cos \omega &= \frac{|\langle x, y\rangle|}{\|x\| \|y\|}\\
			&= \frac{|2(1)(-1) + (1)(-1) + (2)(-1) + 3(2)(-1)|}{\sqrt{2(1)(1) + (1)(2) + (1)(2) + 3(2)(2)} \sqrt{(2)(-1)(-1) + (-1)(-1) + (-1)(-1) + (3)(-1)(-1)}}\\
			&= \frac{|-2-1-2-6|}{\sqrt{2+2+2+12} \sqrt{2+1+1+3}}\\
			&= \frac{|-11|}{\sqrt{18} \sqrt{7}}\\
			&= \frac{|11|}{\sqrt{126}}\\
			&= \frac{11}{\sqrt{126}}
		\end{align*}
		And so we end up that $\omega = \arccos \frac{11}{\sqrt{126}} \approx 11.5 \deg$.
	\end{enumerate}
}

\problem Consider $\mathbb{R}^3$ with the inner product:
\begin{align*}
	\langle x, y \rangle &= x^\top \begin{bmatrix}
		2 & 1 & 0\\ 1 & 2 & -1\\ 0 & -1 & 2
	\end{bmatrix}y
\end{align*}
and let $e_1, e_2, e_3$ be the canonical basis of $\mathbb{R}^3$. 
\begin{itemize}
	\item Define the orthogonal projection $\pi_U(e_2)$ onto $U = span[e_1, e_3]$
	\item Compute the distance $d(e_2, U)$
	\item Draw the scenario.
\end{itemize}
\solution{
	Since we want to project $e_2$ into the set $span[e_1, e_3]$ for the projction $\pi_U(e_2)$ there would be $\lambda_1, \lambda_2$ such that:
	\begin{align*}
		\pi_U(e_2) &= \lambda_1 \cdot e_1 + \lambda_2 \cdot e_3
	\end{align*}
	so we must have that:
	\begin{align*}
		\langle e_1, e_2 - \pi_U(e_2)\rangle &= 0\\
		\langle e_3, e_2 - \pi_U(e_2)\rangle &= 0
	\end{align*}
	So let us first compute what this product must be:
	\begin{align*}
		\langle (x_1, x_2, x_3), (y_1, y_2, y_3)\rangle &= \begin{bmatrix}
			x_1 & x_2 & x_3
		\end{bmatrix}\begin{bmatrix}
			2 & 1 & 0\\ 1 & 2 & -1\\ 0 & -1 & 2
		\end{bmatrix}\begin{bmatrix}
			y_1 \\ y_2 \\ y_3
		\end{bmatrix}\\
		&= \begin{bmatrix}
			x_1 & x_2 & x_3
		\end{bmatrix} \begin{bmatrix}
			2y_1 + y_2\\ y_1 + 2y_2 - y_3\\ 2y_3 - y_2
		\end{bmatrix}\\
		&= 2x_1y_1 + x_1y_2 + y_1x_2 + 2x_2y_2 - x_2y_3 + 2x_3y_3 - x_3y_2
	\end{align*}
}
\end{document}